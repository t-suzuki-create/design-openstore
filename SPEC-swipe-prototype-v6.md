# OpenStore スワイプ型物件仕分けアプリ 仕様書

**バージョン**: v6.0
**プロトタイプファイル**: `design/swipe-prototype-v6.html`
**対象ユーザー**: 出店開発会社（店舗管理部スタッフ）
**プラットフォーム**: LINEミニアプリ（モバイルファースト、最大幅430px）

---

## 1. 概要

不動産物件をTinder風のスワイプUIで「興味あり / 興味なし」に仕分けし、興味ある物件の内見申込までをワンストップで行うLINEミニアプリ。

### コンセプト

- 1物件を数秒で判断できるスワイプ体験
- 配信された物件は**4日で自動スキップ**（未仕分け放置を防止）
- 興味あり物件から一括内見リクエスト

---

## 2. 画面一覧

| # | 画面ID | 画面名 | 説明 |
|---|--------|--------|------|
| 1 | `welcome` | ウェルカム | LINEログイン画面 |
| 2 | `register` | 会員登録 | 会社名・担当者名・電話番号 |
| 3 | `guide` | 使い方ガイド | 3ステップ説明 |
| 4 | `criteria-biz` | 業態選択 | 出店業態の複数選択 |
| 5 | `criteria-area` | エリア設定 | 駅選択（検索+タグ） |
| 6 | `criteria-specs` | 物件条件 | 坪数・階数・賃料設定 |
| 7 | `tutorial` | チュートリアル | スワイプ操作の説明 |
| 8 | `dashboard` | ダッシュボード | ホーム画面 |
| 9 | `swipe` | 物件仕分け | メインスワイプ機能 |
| 10 | `swipe-complete` | 仕分け完了 | スワイプ結果サマリー |
| 11 | `skipped` | スキップ済み物件 | 直近30日の自動スキップ一覧 |
| 12 | `property-detail` | 物件詳細 | フルページ物件情報 |
| 13 | `interested` | 興味あり物件 | 気になる物件リスト+一括内見申込 |
| 14 | `viewings` | 内見 | 内見一覧（タブ切替） |
| 15 | `viewing-detail` | 内見日程調整 | 日程選択・確定 |
| 16 | `criteria` | 検索条件 | 登録済み条件の管理 |
| 17 | `criteria-detail` | 条件詳細 | 条件の統計・編集 |

---

## 3. 画面遷移

```
ウェルカム → 会員登録 → 使い方ガイド → 業態選択 → エリア設定 → 物件条件 → チュートリアル
    ↓
ダッシュボード（ホーム）
    ├── 物件仕分け → 仕分け完了 → 興味あり物件
    ├── スキップ済み一覧
    ├── 興味あり物件 → 物件詳細 / 一括内見リクエスト
    ├── 内見一覧 → 内見日程調整 → 物件詳細
    └── 検索条件 → 条件詳細
```

### ボトムナビゲーション（4タブ）

| タブ | アイコン | ラベル | バッジ | 遷移先 |
|------|----------|--------|--------|--------|
| 1 | チェックマーク | 仕分け | 未仕分け件数 | ダッシュボード |
| 2 | ハート | 興味あり | 興味あり件数 | 興味あり物件 |
| 3 | カレンダー | 内見 | 調整中件数 | 内見一覧 |
| 4 | 歯車 | 条件 | — | 検索条件 |

**非表示タイミング**: オンボーディング画面、スワイプ画面

---

## 4. オンボーディングフロー

### 4.1 会員登録

| 項目 | 入力形式 |
|------|----------|
| 会社名 | テキスト入力 |
| 担当者名 | テキスト入力 |
| 携帯電話番号 | テキスト入力 |

### 4.2 使い方ガイド（3ステップ）

1. 物件が届く（毎日AIがおすすめ物件を配信）
2. スワイプで仕分け（右＝興味あり、左＝興味なし）
3. まとめて内見申込

### 4.3 業態選択

カテゴリ別チェックボックスで複数選択。

| カテゴリ | 選択肢 |
|----------|--------|
| 飲食 | ヘビー飲食、軽飲食、バー・クラブ、スナック |
| 美容 | 美容室・理容室、ネイルサロン、まつげサロン、エステサロン、リラクゼーション |
| ジム | フィットネス、ゴルフスクール、道場・スポーツ教室 |
| 娯楽 | カラオケ、漫画カフェ、ゲームセンター、パチンコ |
| その他 | 物販、医療施設、学習塾・教室、サービス業 |

### 4.4 エリア設定（駅選択）

- **条件名**: テキスト入力
- **駅選択**: インラインの検索+結果リスト方式
  - タグボタン（5種）で一括選択: ターミナル駅、商業立地、オフィス需要、大学生が多い、おすすめ住居エリア
  - テキスト検索でリアルタイムフィルタリング
  - クリックで下部の選択済みリストに追加
  - 選択済み駅はチップ表示（×で削除可能）
- **徒歩**: 1分〜10分の選択

### 4.5 物件条件

| 項目 | 入力形式 |
|------|----------|
| 坪数 | 最小〜最大 |
| 階数 | チェックボックス（B1以下 / 1F / 2F / 3F以上） |
| 坪賃料上限 | 数値入力（万円/坪） |
| 初期費用上限 | 数値入力（万円） |

---

## 5. ダッシュボード

### 5.1 挨拶

時間帯に応じた動的挨拶:
- 5〜11時: おはようございます
- 11〜17時: こんにちは
- 17〜5時: お疲れ様です

### 5.2 未仕分けCTA（メインカード）

ダークグラデーション背景の目立つカード。

```
未仕分けの物件
7 件

🟢 今日    4件
🟡 1日前   3件
🟠 2日前   0件
🔴 3日前   0件

[ 仕分けを始める → ]

直近30日のスキップ  7件 >
```

- 件数はスワイプ進行に応じて動的に更新
- 「仕分けを始める」ボタンにパルスアニメーション
- 「直近30日のスキップ」リンクでスキップ済み一覧へ遷移

### 5.3 直近7日間の統計

| 指標 | 表示例 | 上部カラーライン |
|------|--------|----------------|
| 配信 | 12 | 黒 |
| 興味あり | 5 | 緑 |
| 内見 | 2 | 青 |
| 興味あり率 | 42% | 黄 |

### 5.4 対応が必要（アクション項目）

緊急度に応じた左ボーダー色付きのカード。

| アクション | アイコン | ボーダー色 |
|------------|----------|------------|
| 内見日程の回答待ち | ⚡ | 黄（amber） |
| 内見予定の確認 | 📋 | 青（blue） |

---

## 6. 物件仕分け（スワイプ）

### 6.1 物件の期限管理

| 経過日数 | ステータス | カードバッジ | バッジ色 |
|----------|-----------|-------------|---------|
| 0日（今日配信） | pending | 「今日」 | 🟢 緑 |
| 1日前 | pending | 「1日前」 | 🟡 黄 |
| 2日前 | pending | 「2日前」 | 🟠 黄橙 |
| 3日前 | pending | 「3日前」 | 🔴 赤（パルスアニメ） |
| **4日以上** | **expired** | — | **自動スキップ（カード非表示）** |

- 古い順（期限が近い順）にスワイプ表示
- スキップは「興味なし」とは別ステータス → **興味あり率に影響しない**
- 直近30日分のスキップ物件は一覧で閲覧可能

### 6.2 物件写真の自動取得（Google API）

各物件の写真1枚目・2枚目はGoogle APIで自動生成する。

| 順番 | 内容 | API | パラメータ例 |
|------|------|-----|-------------|
| 1枚目 | **地図（ピン刺し）** | Google Maps Static API | `center={lat},{lng}&zoom=16&size=600x400&markers=color:red|{lat},{lng}` |
| 2枚目 | **建物外観写真** | Google Street View Static API | `location={lat},{lng}&size=600x400&heading=auto&pitch=0&fov=90` |
| 3枚目〜 | 内装・間取り等 | 手動アップロード | 運営が登録 |

- 物件データに緯度経度（`lat`, `lng`）を持たせ、写真URLを動的に生成
- Street Viewが利用不可の地点はフォールバック画像（グラデーション+建物アイコン）を表示
- APIキーはサーバーサイドで署名付きURLを生成し、クライアントに直接露出させない

### 6.3 カード構造

```
┌─────────────────────────────┐
│  [写真ドット]  ● ● ○ ○     │  ← 写真数インジケーター
│  [期限バッジ] 今日           │  ← 左上
│                             │
│     写真エリア（全面）        │  ← タップで左右切替
│                             │
│  [興味あり] スタンプ         │  ← 右スワイプ時に表示
│  [興味なし] スタンプ         │  ← 左スワイプ時に表示
│                    [📄][ℹ️] │  ← サイドボタン（概要書/詳細）
├─────────────────────────────┤
│ 物件名（最大2行）            │
│ 🚉 駅名  徒歩N分             │  ← グラデーションオーバーレイ
│ N坪  NF  💰 N万円            │
└─────────────────────────────┘
```

### 6.4 カードスタック

| レイヤー | スケール | Y位置 | Z-index |
|----------|---------|-------|---------|
| メインカード | 1.0 | 0px | 2 |
| 背景カード1 | 0.975 | +4px | 1 |
| 背景カード2 | 0.95 | +8px | 0 |

ドラッグ中、背景カード1はメインカードの移動量に比例して拡大。

### 6.5 スワイプ操作

| 操作 | 条件 | アクション |
|------|------|-----------|
| 右スワイプ | 100px以上 or 速度800px/s以上 | 興味あり |
| 左スワイプ | 100px以上 or 速度800px/s以上 | 興味なし |
| 閾値未満 | — | スナップバック |
| 写真左半分タップ | — | 前の写真 |
| 写真右半分タップ | — | 次の写真 |

### 6.6 アクションバー

| ボタン | サイズ | 機能 |
|--------|--------|------|
| 戻す | 48×48 | 直前のスワイプを取り消し |
| 興味なし（×） | 64×64 | 左スワイプと同等 |
| 興味あり（✓） | 64×64 | 右スワイプと同等 |
| 詳細（ℹ） | 48×48 | 物件詳細シートを表示 |

### 6.7 プログレスバー

- テキスト: `{現在} / {合計}` （例: "1 / 7"）
- バー: 割合に応じて緑色で塗りつぶし

### 6.8 仕分け完了画面

```
✓ チェック完了！

興味あり  N件
興味なし  N件
スキップ  N件（期限切れ）  ← skippedCount > 0 の場合のみ

[ 興味あり物件を見る ]
[ ホームに戻る ]
```

---

## 7. スキップ済み物件一覧

ダッシュボードCTAの「直近30日のスキップ」リンクから遷移。

- 説明文: 「4日以上経過した未仕分け物件は自動的にスキップされます。直近30日分を表示しています。」
- 各物件: 物件名、駅・徒歩・坪数・賃料、経過日数
- 閲覧のみ（アクション不可）

---

## 8. 物件詳細

### 8.1 ヒーローカード

- 高さ: 220px
- 背景: 物件写真 or グラデーション
- オーバーレイ: 物件名、駅+徒歩

### 8.2 キーバー（3カラム）

| 坪数 | 階数 | 月額賃料（アクセントカラー） |

### 8.3 物件情報テーブル

| 項目 | 値 |
|------|----|
| 坪賃料 | 算出値 |
| 初期費用 | 応相談 等 |
| 敷金 | N ヶ月 |
| 礼金 | なし 等 |
| 管理費 | N円/月 |

### 8.4 設備情報テーブル

| 項目 | 値 |
|------|----|
| 状態 | スケルトン 等 |
| 給排水 | あり 等 |
| トイレ | 専有/共有 |
| エアコン | あり 等 |
| ダクト | あり 等 |
| 天井高 | N.Nm |

### 8.5 出店可能業態

カテゴリ別に表示。OK業態は緑チェック付き黒バッジ、NG業態はグレー×バッジ。

### 8.6 ボトムアクション

- Google マップで見る
- 物件概要書を見る

---

## 9. 興味あり物件

### 9.1 リスト表示

日付グループ（今日 / 昨日 / 日付）ごとに物件を表示。

各アイテム:
- チェックボックス（選択用）
- サムネイル（60×60）
- 物件名 + 「内見リク」バッジ（申込済みの場合）
- 駅・坪数・賃料
- 詳細遷移ボタン

### 9.2 選択・一括内見申込

- 物件をチェックで選択
- 選択バー: 「N件選択」表示 + 「N件の内見をリクエスト」ボタン
- 選択時: カード背景が薄緑（accent-light）に変化

### 9.3 内見リクエストシート

ボトムシート形式で表示:

- 選択済み物件一覧
- 希望日時ピッカー（日付 + 時間帯）
- 備考テキストエリア
- 送信ボタン

---

## 10. 内見管理

### 10.1 タブ

| タブ | 内容 |
|------|------|
| 調整中 | 日程回答待ち・運営返答待ちの物件 |
| 予定 | 日程確定済みの内見 |
| 完了 | 実施済みの内見 |

### 10.2 内見カード

```
┌─────────────────────────────┐
│ 📅 日程が提案されています     │ ← ヘッダー
├─────────────────────────────┤
│ [thumb]  物件名              │
│          住所                │
│                   [回答待ち] │ ← ステータスバッジ
└─────────────────────────────┘
```

### 10.3 日程調整画面

- ヒーロー + キーバー（物件情報）
- ステータスバッジ（回答待ち / 確定）
- 提案日程リスト（ラジオ選択）
  - 例: 2月20日（木）14:00〜15:00
  - 選択時に緑アクセント
- アクションボタン:
  - 「この日程で確定する」（日程選択後に有効化）
  - 「都合が合わない」

---

## 11. 検索条件管理

### 11.1 条件一覧

カード形式で各条件を表示:

- 条件名 + ステータスバッジ（有効 / 停止中）
- サマリー: 業態 / 設定駅数 / 徒歩 / 坪数
- 統計グリッド: 経過日数 / 設定駅数 / 配信件数 / 興味あり率 / 内見済

### 11.2 条件詳細

- 配信実績サマリー（配信済みN件）
- 仕分け結果バーチャート（興味あり / 興味なし / 未仕分け）
- 内見実績（内見済み / 調整中）
- 30日間配信数推移チャート
- 条件設定の詳細表示
- アクション: 条件を編集 / 停止する

---

## 12. デザインシステム

### 12.1 カラートークン

| トークン | 値 | 用途 |
|----------|----|------|
| `--accent` | #06C755 | LINE緑・メインアクセント |
| `--accent-light` | #E8F8EE | 選択状態の背景 |
| `--accent-dark` | #05A847 | ホバー・アクティブ |
| `--primary` | #1A1D23 | テキスト・ボタン |
| `--bg` | #F7F8FA | ページ背景 |
| `--bg-white` | #FFFFFF | カード背景 |
| `--text-primary` | #1A1D23 | 本文テキスト |
| `--text-secondary` | #6B7280 | 補助テキスト |
| `--text-tertiary` | #9CA3AF | 薄いテキスト |
| `--red` | #EF4444 | エラー・興味なし |
| `--blue` | #3B82F6 | 情報・リンク |
| `--amber` | #F59E0B | 警告・回答待ち |
| `--border` | #E5E7EB | ボーダー |

### 12.2 タイポグラフィ

| トークン | サイズ | 用途 |
|----------|--------|------|
| `--text-xs` | 11px | キャプション・バッジ |
| `--text-sm` | 13px | 補助テキスト |
| `--text-base` | 15px | 本文 |
| `--text-lg` | 17px | セクション見出し |
| `--text-xl` | 20px | ページタイトル |

**フォント**: `-apple-system, BlinkMacSystemFont, "Hiragino Sans", "Noto Sans JP", sans-serif`

### 12.3 スペーシング

| トークン | 値 |
|----------|----|
| `--space-xs` | 4px |
| `--space-sm` | 8px |
| `--space-md` | 12px |
| `--space-lg` | 16px |
| `--space-xl` | 20px |

### 12.4 角丸

| トークン | 値 | 用途 |
|----------|----|------|
| `--radius-sm` | 8px | 小要素 |
| `--radius-md` | 12px | カード・入力 |
| `--radius-lg` | 16px | モーダル・CTA |
| `--radius-full` | 9999px | バッジ・ボタン |

### 12.5 シャドウ

| トークン | 値 |
|----------|----|
| `--shadow-sm` | `0 1px 2px rgba(0,0,0,0.04)` |
| `--shadow-md` | `0 2px 8px rgba(0,0,0,0.06)` |
| `--shadow-lg` | `0 4px 16px rgba(0,0,0,0.08)` |

### 12.6 レイアウト定数

| トークン | 値 |
|----------|----|
| `--header-height` | 52px |
| `--bottom-nav-height` | 56px |
| 最大幅 | 430px |

### 12.7 CSSプレフィックス規則

| プレフィックス | 用途 |
|---------------|------|
| `ds-` | 物件詳細シート（Detail Sheet） |
| `vd-` | 内見詳細（Viewing Detail） |
| `dash-` | ダッシュボード |
| `cd-` | 条件詳細（Criteria Detail） |
| `sp-` | 駅選択ピッカー（Station Picker） |
| `vr-` | 内見リクエスト（Viewing Request） |

---

## 13. データ構造

### 13.1 物件データ（Property）

```
{
  id:       Number    // 一意ID
  name:     String    // "渋谷区神南一丁目 商業ビル用地"
  station:  String    // "渋谷駅"
  walk:     String    // "5分"
  area:     String    // "45.2坪"
  floor:    String    // "B1-5F"
  rent:     String    // "350万円"
  daysAgo:  Number    // 配信からの経過日数（0=今日, 4以上=スキップ）
  status:   String    // "pending"
  lat:      Number    // 緯度（Google API用）
  lng:      Number    // 経度（Google API用）
  photos:   Array     // 写真配列（下記）
  bizOk:    Array     // 出店可能業態 ["レストラン", "カフェ", ...]
}
```

### 13.2 写真データ（Photo）

```
{
  type:   "img" | "grad"   // 画像 or CSSグラデーション
  src:    String            // URL or グラデーション文字列
  label:  String            // "地図", "外観", "内装", "間取り"
}
```

**写真の自動生成ルール**:

| index | label | 生成方法 |
|-------|-------|---------|
| 0 | 地図 | Google Maps Static API で緯度経度にピン刺し画像を生成 |
| 1 | 外観 | Google Street View Static API で建物写真を取得 |
| 2〜 | 内装・間取り等 | 運営が手動でアップロード |

- `src` にはサーバーサイドで生成した署名付きURLを格納
- Street View が利用不可の場合は `type: "grad"` でフォールバック

### 13.3 スキップ履歴（SkippedHistory）

```
{
  id:       Number
  name:     String
  station:  String
  walk:     String
  area:     String
  rent:     String
  daysAgo:  Number    // 4以上
}
```

### 13.4 デモデータ内容

**未仕分け物件（7件）**:

| ID | 物件名 | 駅 | 坪数 | 賃料 | 経過日数 |
|----|--------|----|------|------|---------|
| 1 | 渋谷区神南一丁目 商業ビル用地 | 渋谷駅 | 45.2坪 | 350万円 | 今日 |
| 2 | 港区六本木三丁目 オフィスビル | 六本木駅 | 62.8坪 | 520万円 | 今日 |
| 3 | 新宿区歌舞伎町二丁目 店舗用地 | 新宿駅 | 28.5坪 | 180万円 | 今日 |
| 4 | 中央区銀座六丁目 商業施設 | 銀座駅 | 85.0坪 | 680万円 | 今日 |
| 5 | 千代田区丸の内一丁目 複合ビル | 東京駅 | 120.5坪 | 980万円 | 1日前 |
| 6 | 目黒区自由が丘二丁目 店舗 | 自由が丘駅 | 32.0坪 | 150万円 | 1日前 |
| 7 | 渋谷区恵比寿一丁目 飲食ビル | 恵比寿駅 | 25.3坪 | 55万円 | 1日前 |

**スキップ済み物件（直近30日・7件）**:

| ID | 物件名 | 駅 | 経過日数 |
|----|--------|----|---------|
| 8 | 品川区五反田二丁目 路面店 | 五反田駅 | 5日前 |
| 101 | 台東区浅草一丁目 店舗 | 浅草駅 | 7日前 |
| 102 | 豊島区池袋二丁目 商業ビル | 池袋駅 | 10日前 |
| 103 | 世田谷区三軒茶屋一丁目 路面店 | 三軒茶屋駅 | 14日前 |
| 104 | 文京区本郷三丁目 オフィス | 本郷三丁目駅 | 19日前 |
| 105 | 杉並区高円寺南三丁目 店舗 | 高円寺駅 | 24日前 |
| 106 | 北区赤羽一丁目 飲食ビル | 赤羽駅 | 28日前 |

---

## 14. 駅選択ピッカー

### 14.1 構成要素

1. **タグボタン**（5種）: プリセットの駅グループを一括選択/解除
2. **検索入力**: 駅名テキストでリアルタイムフィルタリング
3. **検索結果リスト**: 入力欄の直下に接続したドロップダウン（最大200px）
4. **カウンター**: 「選択中: N駅」+「すべてクリア」
5. **選択済みリスト**: チップ形式で表示（×ボタンで個別削除）

### 14.2 タグカテゴリ

| タグ名 | 含まれる駅（例） |
|--------|-----------------|
| ターミナル駅 | 渋谷、新宿、池袋、東京、品川 |
| 商業立地 | 銀座、表参道、原宿、自由が丘 |
| オフィス需要 | 大手町、丸の内、六本木、赤坂 |
| 大学生が多い | 高田馬場、駒場東大前、御茶ノ水 |
| おすすめ住居エリア | 中目黒、三軒茶屋、下北沢、吉祥寺 |

### 14.3 検索マスタ

26駅のマスタデータ。各駅に `name`、`pref`、`lines`（路線配列）、`tags`（カテゴリ配列）を保持。

---

## 15. アニメーション・インタラクション

| 要素 | アニメーション | 詳細 |
|------|--------------|------|
| CTAボタン | パルス | 2.5秒周期のbox-shadow点滅 |
| 3日前バッジ | パルス | 1.5秒周期の赤shadow点滅 |
| カードフライオフ | transform | 400ms ease-out、X±500px + rotation ±15° |
| カードスナップバック | transform | 300ms ease |
| 写真切替 | フェード | 250ms ease |
| ページ遷移 | スライド | 300ms ease-out、方向はページ順序に依存 |
| 完了アイコン | スケールイン | 500ms ease 0.1s |
| トースト | フロストガラス | backdrop-filter: blur(12px) |
| 詳細シート | スライドアップ | 300ms、背景オーバーレイ付き |

---

## 16. バージョン履歴

| Ver | 主な変更 |
|-----|---------|
| v1 | ベーススワイプUI、物件カード、写真切替 |
| v2 | オンボーディング、興味ありリスト、一括内見リクエスト |
| v3 | ダッシュボード、内見管理（タブ）、日程調整、検索条件管理 |
| v4 | バグ修正（ナビ遷移、写真表示）、デザインブラッシュアップ（パルスアニメ、グラスモーフィズム等） |
| v5 | CSS統合、駅選択ピッカー追加、完了タブ空状態改善 |
| v6 | **4日自動スキップ制度**、日別内訳CTA、期限バッジ、スキップ済み一覧ページ |
